<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggbulksurv">
<title>Interfacing with other survival packages • ggbulksurv</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interfacing with other survival packages">
<meta property="og:description" content="ggbulksurv">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggbulksurv</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ggbulksurv.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/customizing-plots.html">Customizing Plots</a>
    <a class="dropdown-item" href="../articles/interfacing-with-other-packages.html">Interfacing with other survival packages</a>
    <a class="dropdown-item" href="../articles/faqs.html">Frequently Asked Questions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Interfacing with other survival packages</h1>
            
      
      
      <div class="d-none name"><code>interfacing-with-other-packages.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://qhuitan.github.io/ggbulksurv/">ggbulksurv</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/survminer/index.html" class="external-link">survminer</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: ggpubr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'survminer'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:survival':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     myeloma</span></span></code></pre></div>
<p>Two of the most popular packages for survival analysis are <a href="https://cran.r-project.org/web/packages/survival/index.html" class="external-link">survival</a>
and <a href="https://cran.r-project.org/web/packages/survminer/index.html" class="external-link">survminer</a>.
This vignette will demonstrate how to use <code>ggbulksurv</code>’s
output as input to other survival packages.</p>
<p>We first start by documenting the three functions that
<code><a href="../reference/run_bulksurv.html">run_bulksurv()</a></code> wraps around. At each stage, we demonstrate
how this can be used as input to other packages for the advanced
user.</p>
<div class="section level2">
<h2 id="behind-the-scenes">Behind the scenes<a class="anchor" aria-label="anchor" href="#behind-the-scenes"></a>
</h2>
<p>The <code><a href="../reference/run_bulksurv.html">run_bulksurv()</a></code> command makes several choices for the
user, with the caveat that these assumptions tend to hold under most
conditions. Users who desire total control over the process should read
this section for a more detailed walkthrough.</p>
<p><code><a href="../reference/run_bulksurv.html">run_bulksurv()</a></code> is a wrapper around the 3 following
functions:</p>
<ol style="list-style-type: decimal">
<li>
<code>get_indiv_surv</code>: Converts a bulk survival table into an
individual survival table.</li>
<li>
<code>fit_surv</code>: Fits a survival object from
<code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survival::survfit()</a></code>.</li>
<li>
<code>plot_surv</code>: Plots a survival curve using
<code><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html" class="external-link">survminer::ggsurvplot()</a></code>.</li>
</ol>
<p>This section takes you through the 3 steps that
<code><a href="../reference/run_bulksurv.html">run_bulksurv()</a></code> wraps around.</p>
</div>
<div class="section level2">
<h2 id="get-individual-survivals">1. Get individual survivals<a class="anchor" aria-label="anchor" href="#get-individual-survivals"></a>
</h2>
<p><code>get_indiv_surv</code> converts a table of bulk survival data
into individual survivals. Each row now represents an individual.
<code>day</code> represents the number of days lived, while
<code>status</code> is either 0 (censored) or 1 (dead).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_isurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_indiv_surv.html">get_indiv_surv</a></span><span class="op">(</span><span class="va">sample_data</span>,</span>
<span>                           sample_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"Drug1"</span>, <span class="st">"Drug2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_isurv</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   condition   day status</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> WT            1      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> WT            1      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> WT            1      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Drug1         1      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Drug1         1      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Drug1         1      1</span></span></code></pre></div>
<p>We now have a <code>tibble</code> with one individual per row.</p>
<p>At this point, this data can be used as input to other packages, such
as <code>survminer()</code> and <code>survival</code>.</p>
</div>
<div class="section level2">
<h2 id="fit-the-survival-object">2. Fit the survival object<a class="anchor" aria-label="anchor" href="#fit-the-survival-object"></a>
</h2>
<p><code>fit_surv</code> creates a <code>survfit</code> object for
<code>day</code> and <code>status</code>, then fits a survival curve by
<code>condition</code>. It takes in a <code>data.frame</code> with one
individual per row, and creates a <code>survfit</code> object using the
<code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survival::survfit()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit survival object</span></span>
<span><span class="va">df_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_surv.html">fit_surv</a></span><span class="op">(</span><span class="va">df_isurv</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: survfit(formula = Surv(day, status) ~ condition, data = df_isurv)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  n events median 0.95LCL 0.95UCL</span></span>
<span><span class="co">#&gt; condition=WT    50     47   20.0      19      21</span></span>
<span><span class="co">#&gt; condition=Drug1 50     46    4.5       4       6</span></span>
<span><span class="co">#&gt; condition=Drug2 50     42   33.0      32      35</span></span></code></pre></div>
<p>Alternatively, you can fit this manually using the
<code>survival</code> package:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_isurv</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">day</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">condition</span>,</span>
<span>                                data <span class="op">=</span> <span class="va">df_isurv</span><span class="op">)</span></span></code></pre></div>
<p>Drug1 has the shortest median lifespan of 4.5 days, with a 95%
confidence interval (95% CI) of 4 to 6 days. In contrast, Drug2 has the
longest median lifespan of 33 days, with a 95% CI of 32 to 35 days.</p>
</div>
<div class="section level2">
<h2 id="plot-the-survival-object">3. Plot the survival object<a class="anchor" aria-label="anchor" href="#plot-the-survival-object"></a>
</h2>
<div class="section level3">
<h3 id="using-plot_surv">Using plot_surv()<a class="anchor" aria-label="anchor" href="#using-plot_surv"></a>
</h3>
<p><code>plot_surv</code> is a wrapper around [survminer::ggsurvplot()].
As such, all additional arguments passed to <code>plot_surv</code> will
be passed to <code><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html" class="external-link">survminer::ggsurvplot()</a></code>. Some useful examples
are illustrated below:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_isurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_indiv_surv.html">get_indiv_surv</a></span><span class="op">(</span><span class="va">sample_data</span>,</span>
<span>                           sample_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"Drug1"</span>, <span class="st">"Drug2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_surv.html">plot_surv</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">df_fit</span>, </span>
<span>          type <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>          data <span class="op">=</span> <span class="va">df_isurv</span><span class="op">)</span></span></code></pre></div>
<p><img src="interfacing-with-other-packages_files/figure-html/surv_detail-1.png" width="700"></p>
<div class="section level4">
<h4 id="changing-legend-positions">Changing legend positions<a class="anchor" aria-label="anchor" href="#changing-legend-positions"></a>
</h4>
<p>Specifying a position (<code>right</code>, <code>left</code>,
<code>bottom</code> or <code>top</code>) with
<code>legend.position</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_surv.html">plot_surv</a></span><span class="op">(</span><span class="va">df_fit</span>, </span>
<span>          type <span class="op">=</span> <span class="st">"survival"</span>, </span>
<span>          data <span class="op">=</span> <span class="va">df_isurv</span>,</span>
<span>          sample_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"Drug1"</span>, <span class="st">"Drug2"</span><span class="op">)</span>,</span>
<span>          print_stats <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="st">"right"</span> <span class="co"># Change legend position</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<p><img src="interfacing-with-other-packages_files/figure-html/custom-legright-1.png" width="700"></p>
<p>Specific coordinates can also be used. For bottom left, use
<code>legend.position = c(0,0)</code>; for top right, use
<code>legend.position = c(1,1)</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_surv.html">plot_surv</a></span><span class="op">(</span><span class="va">df_fit</span>, </span>
<span>          type <span class="op">=</span> <span class="st">"survival"</span>, </span>
<span>          sample_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"Drug1"</span>, <span class="st">"Drug2"</span><span class="op">)</span>,</span>
<span>          print_stats <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          data <span class="op">=</span> <span class="va">df_isurv</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span> <span class="co"># Specify coordinates</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<p><img src="interfacing-with-other-packages_files/figure-html/custom-legcoord-1.png" width="700"></p>
<p>It doesn’t fit - in fact, the legend is partially obscuring our x and
y axes.</p>
<p>We can simplify the legend by removing the legend title and the
trailing <code>condition=</code> symbol:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_order</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"Drug1"</span>, <span class="st">"Drug2"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_surv.html">plot_surv</a></span><span class="op">(</span><span class="va">df_fit</span>, </span>
<span>          type <span class="op">=</span> <span class="st">"survival"</span>, </span>
<span>          sample_order <span class="op">=</span> <span class="va">sample_order</span>,</span>
<span>          data <span class="op">=</span> <span class="va">df_isurv</span>,</span>
<span>          print_stats <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.09</span>,<span class="fl">0.2</span><span class="op">)</span>, <span class="co"># Specify coordinates</span></span>
<span>          legend.title <span class="op">=</span> <span class="st">""</span>, <span class="co"># Remove legend title</span></span>
<span>          legend.labs <span class="op">=</span> <span class="va">sample_order</span> <span class="co"># Remove `condition=`</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<p><img src="interfacing-with-other-packages_files/figure-html/custom-rmlegtitle-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="adding-confidence-intervals-and-median-survival">Adding confidence intervals and median survival<a class="anchor" aria-label="anchor" href="#adding-confidence-intervals-and-median-survival"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_surv.html">plot_surv</a></span><span class="op">(</span><span class="va">df_fit</span>, </span>
<span>          data <span class="op">=</span> <span class="va">df_isurv</span>,</span>
<span>          type <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>          add.conf.int <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Add 95% confidence interval</span></span>
<span>          legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="interfacing-with-other-packages_files/figure-html/custom-addci-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_surv.html">plot_surv</a></span><span class="op">(</span><span class="va">df_fit</span>, </span>
<span>          data <span class="op">=</span> <span class="va">df_isurv</span>,</span>
<span>          type <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>          add.median.survival <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Add median survival line</span></span>
<span>          legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="interfacing-with-other-packages_files/figure-html/custom-addmedsurv-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="customizing-x-axis-day-breaks">Customizing x-axis day breaks<a class="anchor" aria-label="anchor" href="#customizing-x-axis-day-breaks"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_surv.html">plot_surv</a></span><span class="op">(</span><span class="va">df_fit</span>, </span>
<span>          data <span class="op">=</span> <span class="va">df_isurv</span>,</span>
<span>          type <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>          legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>          break.x.by <span class="op">=</span> <span class="fl">5</span> <span class="co"># Breaks every 5 days</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<p><img src="interfacing-with-other-packages_files/figure-html/custom-xbreak-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="putting-it-all-together">Putting it all together:<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_order</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"Drug1"</span>, <span class="st">"Drug2"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_surv.html">plot_surv</a></span><span class="op">(</span><span class="va">df_fit</span>, </span>
<span>          data <span class="op">=</span> <span class="va">df_isurv</span>,</span>
<span>          type <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>          sample_order <span class="op">=</span> <span class="va">sample_order</span>,</span>
<span>          legend.labs <span class="op">=</span> <span class="va">sample_order</span>,            <span class="co"># Rename legend</span></span>
<span>          print_stats <span class="op">=</span> <span class="cn">FALSE</span>,                   <span class="co"># don't print stats</span></span>
<span>          palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span><span class="op">)</span>, <span class="co"># Custom colors</span></span>
<span>          legend.title <span class="op">=</span> <span class="st">""</span>,                     <span class="co"># Remove legend title</span></span>
<span>          legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.9</span><span class="op">)</span>,         <span class="co"># Position legend at top right</span></span>
<span>          add.pval <span class="op">=</span> <span class="cn">TRUE</span>,                        <span class="co"># Add pvalue</span></span>
<span>          add.median.survival <span class="op">=</span> <span class="cn">TRUE</span>             <span class="co"># Add 50% median line</span></span>
<span>             <span class="op">)</span></span></code></pre></div>
<p><img src="interfacing-with-other-packages_files/figure-html/custom-1-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="using-survminerggsurvplot">Using survminer::ggsurvplot()<a class="anchor" aria-label="anchor" href="#using-survminerggsurvplot"></a>
</h3>
<p>Alternatively, you can construct your own plots using
<code><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html" class="external-link">survminer::ggsurvplot</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">survminer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html" class="external-link">ggsurvplot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">df_fit</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">df_isurv</span>,</span>
<span>                      ncensor.plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="interfacing-with-other-packages_files/figure-html/ggsurvplot-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="print-summary-statistics">4. Print summary statistics<a class="anchor" aria-label="anchor" href="#print-summary-statistics"></a>
</h2>
<div class="section level3">
<h3 id="using-the-summary_stats-function">Using the <code>summary_stats</code> function:<a class="anchor" aria-label="anchor" href="#using-the-summary_stats-function"></a>
</h3>
<p>Calculates median survival, logrank test and pairwise logrank
test.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summary_stats.html">summary_stats</a></span><span class="op">(</span><span class="va">df_isurv</span>, </span>
<span>                       type <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats</span></span>
<span><span class="co">#&gt; $median_survival</span></span>
<span><span class="co">#&gt; Call: survfit(formula = Surv(day, status) ~ condition, data = df_isurv)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  n events median 0.95LCL 0.95UCL</span></span>
<span><span class="co">#&gt; condition=WT    50     47   20.0      19      21</span></span>
<span><span class="co">#&gt; condition=Drug1 50     46    4.5       4       6</span></span>
<span><span class="co">#&gt; condition=Drug2 50     42   33.0      32      35</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logrank</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; survival::survdiff(formula = Surv(day, status) ~ condition, data = df_isurv)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  N Observed Expected (O-E)^2/E (O-E)^2/V</span></span>
<span><span class="co">#&gt; condition=WT    50       47     31.2      7.94      12.9</span></span>
<span><span class="co">#&gt; condition=Drug1 50       46     12.5     89.99     128.1</span></span>
<span><span class="co">#&gt; condition=Drug2 50       42     91.3     26.60     123.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Chisq= 186  on 2 degrees of freedom, p= &lt;2e-16 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pairwise</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pairwise comparisons using Log-Rank test </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  df_isurv and condition </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       WT      Drug1  </span></span>
<span><span class="co">#&gt; Drug1 2.3e-14 -      </span></span>
<span><span class="co">#&gt; Drug2 &lt; 2e-16 &lt; 2e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P value adjustment method: BH</span></span></code></pre></div>
<p>This returns a <code>list</code> object, which allows us to
individually pull out the values of interest. For example:</p>
<div class="section level4">
<h4 id="the-logrank-test">The logrank test:<a class="anchor" aria-label="anchor" href="#the-logrank-test"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span><span class="op">$</span><span class="va">logrank</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; survival::survdiff(formula = Surv(day, status) ~ condition, data = df_isurv)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  N Observed Expected (O-E)^2/E (O-E)^2/V</span></span>
<span><span class="co">#&gt; condition=WT    50       47     31.2      7.94      12.9</span></span>
<span><span class="co">#&gt; condition=Drug1 50       46     12.5     89.99     128.1</span></span>
<span><span class="co">#&gt; condition=Drug2 50       42     91.3     26.60     123.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Chisq= 186  on 2 degrees of freedom, p= &lt;2e-16</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># chisq value of logrank test</span></span>
<span><span class="va">stats</span><span class="op">$</span><span class="va">logrank</span><span class="op">$</span><span class="va">chisq</span></span>
<span><span class="co">#&gt; [1] 186.0854</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pvalue of logrank test</span></span>
<span><span class="va">stats</span><span class="op">$</span><span class="va">logrank</span><span class="op">$</span><span class="va">pvalue</span></span>
<span><span class="co">#&gt; [1] 3.909058e-41</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pairwise-log-rank-test">Pairwise log-rank test:<a class="anchor" aria-label="anchor" href="#pairwise-log-rank-test"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span><span class="op">$</span><span class="va">pairwise</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pairwise comparisons using Log-Rank test </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  df_isurv and condition </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       WT      Drug1  </span></span>
<span><span class="co">#&gt; Drug1 2.3e-14 -      </span></span>
<span><span class="co">#&gt; Drug2 &lt; 2e-16 &lt; 2e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P value adjustment method: BH</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># p-values</span></span>
<span><span class="va">stats</span><span class="op">$</span><span class="va">pairwise</span><span class="op">$</span><span class="va">p.value</span></span>
<span><span class="co">#&gt;                 WT       Drug1</span></span>
<span><span class="co">#&gt; Drug1 2.291558e-14          NA</span></span>
<span><span class="co">#&gt; Drug2 3.367080e-24 3.36708e-24</span></span></code></pre></div>
<p>To use a different p-value adjustment method, specify the
p_adjust_method as follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summary_stats.html">summary_stats</a></span><span class="op">(</span><span class="va">df_isurv</span>, </span>
<span>                       type <span class="op">=</span> <span class="st">"all"</span>, </span>
<span>                       p_adjust_method <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats_2</span></span>
<span><span class="co">#&gt; $median_survival</span></span>
<span><span class="co">#&gt; Call: survfit(formula = Surv(day, status) ~ condition, data = df_isurv)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  n events median 0.95LCL 0.95UCL</span></span>
<span><span class="co">#&gt; condition=WT    50     47   20.0      19      21</span></span>
<span><span class="co">#&gt; condition=Drug1 50     46    4.5       4       6</span></span>
<span><span class="co">#&gt; condition=Drug2 50     42   33.0      32      35</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logrank</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; survival::survdiff(formula = Surv(day, status) ~ condition, data = df_isurv)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  N Observed Expected (O-E)^2/E (O-E)^2/V</span></span>
<span><span class="co">#&gt; condition=WT    50       47     31.2      7.94      12.9</span></span>
<span><span class="co">#&gt; condition=Drug1 50       46     12.5     89.99     128.1</span></span>
<span><span class="co">#&gt; condition=Drug2 50       42     91.3     26.60     123.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Chisq= 186  on 2 degrees of freedom, p= &lt;2e-16 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pairwise</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pairwise comparisons using Log-Rank test </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  df_isurv and condition </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       WT      Drug1  </span></span>
<span><span class="co">#&gt; Drug1 6.9e-14 -      </span></span>
<span><span class="co">#&gt; Drug2 &lt; 2e-16 &lt; 2e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P value adjustment method: bonferroni</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="using-the-survminer-package-directly">Using the <code>survminer</code> package directly<a class="anchor" aria-label="anchor" href="#using-the-survminer-package-directly"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test</span> <span class="op">=</span> <span class="fu">survminer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survminer/man/pairwise_survdiff.html" class="external-link">pairwise_survdiff</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">day</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">condition</span>, <span class="co"># Fit a survival object</span></span>
<span>  data <span class="op">=</span> <span class="va">df_isurv</span>,</span>
<span>  p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span> <span class="co"># Use bonferroni correction</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pairwise comparisons using Log-Rank test </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  df_isurv and condition </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       WT      Drug1  </span></span>
<span><span class="co">#&gt; Drug1 6.9e-14 -      </span></span>
<span><span class="co">#&gt; Drug2 &lt; 2e-16 &lt; 2e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P value adjustment method: bonferroni</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># obtain specific p-values</span></span>
<span><span class="va">test</span><span class="op">$</span><span class="va">p.value</span></span>
<span><span class="co">#&gt;                 WT       Drug1</span></span>
<span><span class="co">#&gt; Drug1 6.874675e-14          NA</span></span>
<span><span class="co">#&gt; Drug2 5.465280e-24 6.73416e-24</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Qian Hui Tan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
